<div class="expense-form-section" *ngIf="expenseService.participants().length > 0">
  <h2 class="section-header">Add Expense</h2>
  
  <mat-card class="expense-card">
    <mat-card-content>
      <form class="expense-form">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Description</mat-label>
          <input 
            matInput 
            [ngModel]="description()"
            (ngModelChange)="description.set($event)"
            name="description"
            placeholder="What did you pay for?">
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Amount</mat-label>
          <input 
            matInput 
            type="number" 
            [ngModel]="amount()"
            (ngModelChange)="amount.set($event)"
            name="amount"
            placeholder="0.00"
            step="0.01"
            min="0">
          <span matPrefix>$&nbsp;</span>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Paid by</mat-label>
          <mat-select [ngModel]="paidBy()" (ngModelChange)="paidBy.set($event)" name="paidBy">
            <mat-option *ngFor="let participant of expenseService.participants()" [value]="participant.id">
              {{participant.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <div class="split-section">
          <div class="split-header">
            <span>Split among:</span>
            <button 
              mat-button 
              type="button" 
              (click)="selectAllParticipants()"
              class="select-all-button">
              Select All
            </button>
          </div>
          
          <div class="participants-checkboxes">
            <mat-checkbox 
              *ngFor="let participant of expenseService.participants()"
              [checked]="selectedParticipants()[participant.id] || false"
              (change)="onParticipantToggle(participant.id, $event.checked)"
              class="participant-checkbox">
              {{participant.name}}
            </mat-checkbox>
          </div>
        </div>

        <button 
          mat-raised-button 
          color="primary" 
          type="button"
          (click)="addExpense()"
          [disabled]="!canAddExpense()"
          class="add-expense-button">
          Add Expense
        </button>
      </form>
    </mat-card-content>
  </mat-card>
</div>

<div *ngIf="expenseService.participants().length === 0" class="no-participants">
  <p>Add some participants first to start tracking expenses.</p>
</div>
